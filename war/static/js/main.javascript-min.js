function javascriptManageFun(option){var javascriptManage={v:{PER_PAGE_ITEMS:5,ITEMS_COUNT:0,cur_page:0},fn:{init:function(){$("#"+obj.v.formId).find(".create").click(function(){obj.fn.create()});$("#"+obj.v.formId).find(".remove").click(function(){obj.fn.remove()});$("#"+obj.v.formId).find(".update").click(function(){obj.fn.update()});$("#"+obj.v.formId).find(".statistic").click(function(){obj.fn.statistic()});obj.fn.updateCount()},statistic:function(){showLoading($("#"+obj.v.formId));jsonrpc.javascriptManageService.statistic(function(result,exception,profile){removeLoading($("#"+obj.v.formId));if(exception){return}var msg=result;if(msg){showInfo(nc.i18n("res.background.statistics"))}else{showInfo(nc.i18n("res.background.statistics.failure"))}},obj.v.webCrawlerId)},updateCount:function(){showLoading($("#"+obj.v.formId));jsonrpc.javascriptManageService.count(function(result,exception,profile){removeLoading($("#"+obj.v.formId));if(exception){return}obj.v.ITEMS_COUNT=result;obj.fn.query();obj.fn.initPagination(obj.v.cur_page);$("#"+obj.v.formId).find("#JAVASCRIPT_COUNT").html(obj.v.ITEMS_COUNT)},obj.v.webCrawlerId)},query:function(callback){var startIndex=obj.v.cur_page*obj.v.PER_PAGE_ITEMS;moveAllTr(obj.v.tableId);queryLoading(obj.v.tableId);jsonrpc.javascriptManageService.query(function(result,exception,profile){if(exception){removeLoading($("#"+obj.v.formId));return}moveAllTr(obj.v.tableId);var data=result;data=eval(data);obj.v.jsonData=data;var key=""+obj.v.webCrawlerId;javascriptManageMap.put(key,data);for(var i in data){if(isNaN(i)){continue}var id=data[i]["id"];var name=data[i]["name"];var type=data[i]["type"];var jsBody=data[i]["jsBody"];var createDate=data[i]["createDate"];obj.fn.addRow(id,name,type,jsBody,createDate)}$("#"+obj.v.tableId).find(".editJavascriptManage").click(function(){obj.fn.edit($(this).val())});removeLoading($("#"+obj.v.formId));if(callback){callback()}},obj.v.webCrawlerId,startIndex,obj.v.PER_PAGE_ITEMS)},edit:function(id){var data=obj.v.jsonData;for(var i in data){if(isNaN(i)){continue}if(id!=data[i]["id"]){continue}var name=data[i]["name"];var type=data[i]["type"];var jsBody=data[i]["jsBody"];$("#"+obj.v.formId).find("#id").val(id);$("#"+obj.v.formId).find("#name").val(name);$("#"+obj.v.formId).find("#type").val(type);$("#"+obj.v.formId).find("#jsBody").val(jsBody);return}},create:function(){var name=$("#"+obj.v.formId).find("#name").val();var type=$("#"+obj.v.formId).find("#type").val();var jsBody=$("#"+obj.v.formId).find("#jsBody").val();showLoading($("#"+obj.v.formId));jsonrpc.javascriptManageService.create(function(result,exception,profile){removeLoading($("#"+obj.v.formId));if(exception){return}var id=result;if(!isNum(id)){showInfo(nc.i18n("res.create.failure"));return}showInfo(nc.i18n("res.create.success"));obj.fn.query();updateSelect(id,name,"urlJavascriptId")},obj.v.webCrawlerId,name,type,jsBody)},update:function(){var id=$("#"+obj.v.formId).find("#id").val();if(id==null||id.length==0){showInfo(nc.i18n("res.select"));return}var name=$("#"+obj.v.formId).find("#name").val();var type=$("#"+obj.v.formId).find("#type").val();var jsBody=$("#"+obj.v.formId).find("#jsBody").val();showLoading($("#"+obj.v.formId));jsonrpc.javascriptManageService.update(function(result,exception,profile){removeLoading($("#"+obj.v.formId));if(exception){return}id=result;if(!isNum(id)){showInfo(nc.i18n("res.update.failure"));return}showInfo(nc.i18n("res.update.success"));obj.fn.query();updateSelect(id,name,"urlJavascriptId")},obj.v.webCrawlerId,id,name,type,jsBody)},remove:function(){var id=getRadio(obj.v.formId,"javascriptManageList");if(id==null||id.length==0){showInfo(nc.i18n("res.select"));return false}if(!confirm(nc.i18n("res.remove.confirm"))){return}showLoading($("#"+obj.v.formId));jsonrpc.javascriptManageService.remove(function(result,exception,profile){removeLoading($("#"+obj.v.formId));if(exception){return}var msg=result;if(msg){showInfo(nc.i18n("res.remove.success"));obj.fn.query();removeSelect(id,"urlJavascriptId");return}showInfo(nc.i18n("res.remove.failure"))},obj.v.webCrawlerId,id)},addRow:function(id,name,type,jsBody,createDate){var newTr="<tr class='simplehighlight'>";newTr+='<td nowrap>&nbsp;<input type="radio" name="javascriptManageList" id="javascriptManageList" value="'+id+'" class="editJavascriptManage"/></td>';newTr+="<td nowrap>&nbsp;&nbsp;&nbsp;"+name+"</td>";newTr+="<td nowrap>"+type+"</td>";newTr+="<td nowrap>"+createDate+"</td>";newTr+="</tr>";$(newTr).appendTo("#"+obj.v.tableId);$("#"+obj.v.tableId).find("tr:odd").css("background","#FFFFFF");$("#"+obj.v.tableId).find("tr:even").css("background","rgb(247, 247, 247)");$("#"+obj.v.tableId).find(".simplehighlight").hover(function(){$(this).children().addClass("datahighlight")},function(){$(this).children().removeClass("datahighlight")})},initPagination:function(cur_page){$("#"+obj.v.formId).find("#Pagination").pagination(obj.v.ITEMS_COUNT,{num_edge_entries:2,num_display_entries:8,current_page:cur_page,callback:obj.fn.pageselectCallback,items_per_page:obj.v.PER_PAGE_ITEMS,prev_text:nc.i18n("res.page.prev"),next_text:nc.i18n("res.page.next")})},pageselectCallback:function(page_index,jq){obj.v.cur_page=page_index;showLoading($("#"+obj.v.formId));obj.fn.query();return false}}};var obj=this;obj.fn=javascriptManage.fn;obj.v=javascriptManage.v;if(option){obj.v=$.extend(obj.v,option)}}var javascriptManage=new javascriptManageFun();
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>數據采集規則</title>

  </head>

  <body>
	
    <table id="crawlRulesTable" width="100%">
	   <tr>
        <td width="60%" valign="top" >
		<form id="crawlRulesForm" name="crawlRulesForm" method="post">
		<input name="id" type="hidden" id="id" >
		<input name="labelType" type="hidden" id="labelType" value="1" />
		
		<table width="100%" class="table_border2">

		
	  <tr>
        <td nowrap align="right" ><a class="tooltip" title="采集規則的名稱，在創建發布規則時需要通過此名稱來匹配發布的數據。" href="javascript:void(0);">標簽名：</a></td>
        <td colspan="4" class="td_border">
        <div class="inputOver">
        <input name="name" type="text" id="name" value="" style="width:100%;" /> 
        </div>
               </td>
      </tr>
      
	  <tr>
        <td nowrap align="right" class="label">選項：</td>
        <td colspan="4"  class="td_border">
        <div id="optionsDiv" style="float:left;width:100%;height:100%;border-bottom:1px dashed #ccc;">
        <ul>
        <li>
        <input name="isHtmlPreprocess" type="checkbox" id="isHtmlPreprocess" value="true" onclick="crawlRules.fn.changeHtmlPreprocess(this.checked, true)">
        <a class="tooltip" style="font-weight:normal;" title="預處理HTML可以減少源碼匹配範圍，減少匹配耗時。" href="javascript:void(0);">HTML預處理</a>
        </li>
        <li>
        <input name="isOffset" type="checkbox" id="isOffset" value="true" onclick="crawlRules.fn.changeOffset(this.checked, true)">
        <a class="tooltip" style="font-weight:normal;" title="只是用來偏移當前位置，不返回采集數據。" href="javascript:void(0);">采集偏移</a>
        </li>
        <li>
        <input name="isStartPosition" type="checkbox" id="isStartPosition" value="true" >
        <a class="tooltip" style="font-weight:normal;" title="勾選表示從文本的起始位置開始匹配，且不會記錄規則匹配後的位置信息，不勾選表示從上壹次匹配的結束位置開始。"  href="javascript:void(0);">起始位置</a> 
	    </li>	
        <li>
        <input name="isPublic" type="checkbox" id="isPublic" value="true" >
        <a class="tooltip" style="font-weight:normal;" title="公共標簽只被采集壹次，作為公共數據，附加到每條記錄的開始處" href="javascript:void(0);">公共標簽</a>
        </li>
        <li>
        <input name="isTemp" type="checkbox" id="isTemp" value="true" >
        <a class="tooltip" style="font-weight:normal;" title="臨時標簽不會返回采集數據。可以使用‘${標簽名}’的方式提取臨時標簽的值 。"  href="javascript:void(0);">臨時標簽</a>
        </li>
        
        <li>
        <input name="isDataOrigin" type="checkbox" id="isDataOrigin" value="true" onclick="crawlRules.fn.changeOption(this)" >
		<a class="tooltip" style="font-weight:normal;" title="從指定的數據來源采集目標數據，不選擇將從網址正文采集目標數據。"  href="javascript:void(0);">數據來源</a>
		</li>
		
        <li>
        <input name="isCantNull" type="checkbox" id="isCantNull" value="true" >
        <a class="tooltip" style="font-weight:normal;" title="當此規則的采集結果為空時，就廢棄當前采集到的這條記錄。"  href="javascript:void(0);">不能為空</a>
        </li>
        
        <li>
        <input name="unique" type="checkbox" id="unique" value="true" >
        <a class="tooltip" style="font-weight:normal;" title="對所有唯一標簽生成MD5去除重復數據"  href="javascript:void(0);">唯一</a>
        </li>
        </ul>
        </div>
        <table id="optionTable" style="width:100%;">
        	
        	<tr id="isDataOrigin_option" style="display:none;width:100%;">
	        	<td nowrap="nowrap"  width="100"  align="right" >
	        	<a class="tooltip" style="font-weight:normal;" title="從指定的數據來源采集目標數據。"  href="javascript:void(0);">選擇來源</a>
	        	</td>
	        	<td  style="width:100%;"   align="left" colspan="3" nowrap>
	        	<select id="dataOrigin" name="dataOrigin" onchange="crawlRules.fn.changeDataOrigin(this.value)">
	        		<option value="#DATAORIGIN_URL">采集網址</option>
	        		<option value="#DATAORIGIN_COOKIE">Cookie</option>
	        		<option value="#DATAORIGIN_HEADER">Header</option>
	        		<option value="#DATAORIGIN_LABEL">其它標簽</option>
	        	</select>
	        	<a class="tooltip" style="font-weight:normal;" title="是否循環匹配，直到沒有匹配為止，循環匹配到的數據默認用換行符分隔。"  href="javascript:void(0);">循環匹配 ：</a> <input name="isLoop" type="checkbox" id="isLoop" value="true" >
	        	<a class="tooltip" style="font-weight:normal;" title="循環匹配到的數據默認使用換行符分隔，也可以自定義分隔符如','。"  href="javascript:void(0);">分隔符 ：</a> <input style="width:50px;" id="loopSplit" type="text" name="loopSplit" value="" /> 
	        	
	        	</td>
        	</tr>
        	<tr id="valueFromLabelOption" style="display:none;width:100%;">
	        	<td nowrap="nowrap"  width="100"  align="right" >
	        	<a class="tooltip label" style="font-weight:normal;display:none;" title="讀取指定標簽的值。"  href="javascript:void(0);">標簽名：</a>
	        	<a class="tooltip header" style="font-weight:normal;display:none;" title="獲取指定屬性的Header值，如屬性名稱:Status Code、User-Agent、Host、Cookie等 。"  href="javascript:void(0);">屬性名：</a>
	        	</td>
	        	<td  style="width:100%;"   align="left" colspan="3" nowrap>
	        	<div class="inputOver">
	        	<input style="width:270px;" id="valueFromLabel" type="text" name="valueFromLabel" value="" /> 
	        	</div>
	        	</td>
        	</tr>
        	
        </table>
        </td>
      </tr>
      <tr>
      <td nowrap align="right" class="label" valign="middle">匹配規則：</td>
      <td colspan="4" class="td_border">
      	<table style="width:100%;"><tr>
      	<td style="padding-bottom: 5px;" width="100%" >
      	<input name="searchMode" type="radio" id="searchMode" value="string"  onclick="crawlRules.fn.changeSearchMode()" checked="checked">
        <a class="tooltip" style="font-weight:normal;" title="不支持正則，默認懶惰匹配，如：當存在兩個相同的結束字符串時，系統只會匹配最近的壹個。" href="javascript:void(0);">開始結束字符串</a>
        <input name="searchMode" type="radio" id="searchMode" value="regex"  onclick="crawlRules.fn.changeSearchMode()">
        <a class="tooltip" style="font-weight:normal;" title="1.當正則表達式有括號時，返回正則中第壹個分組的內容，否則返回所有匹配的內容<br/>2.當匹配的是HTML標簽時系統自動嵌套匹配<br/>3.正則表達式元字符 ^ $ ( ) * + ? . [ \ { | 加 \ 轉義將作為字符串匹配<br/>4.聚焦輸入框，按Ctrl+F自動轉義正則元字符<br/>5.不區分大小寫匹配，可以通過內嵌標誌表達式'(?i)'來啟用，從內嵌位置開始不區分大小寫<br/>6.不捕獲到組，可以通過內嵌標誌表達式'(?:)'來啟用，如：'(?:src|data-lazyload)'" href="javascript:void(0);">正則表達式</a>
        
        
        <input name="searchMode" type="radio" id="searchMode" value="xpath"  onclick="crawlRules.fn.changeSearchMode()">
        <a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="XPath匹配匹配，考慮速度請優先使用正則匹配。<br/>XPath格式： //*[@id=&quot;comment-123&quot;]/div[1]/div[1]/div[2]/p[1]">XPath</a>
        
        <input name="searchMode" type="radio" id="searchMode" value="csspath"  onclick="crawlRules.fn.changeSearchMode()">
        <a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="CSSPath匹配，考慮速度請優先使用正則匹配。註意循環匹配的站點中使用CSSPath不會循環匹配。<br/>CSSPath格式 ：#comment-123 div div div p">CSSPath</a>
        
        <input name="searchMode" type="radio" id="searchMode" value="jsonpath"  onclick="crawlRules.fn.changeSearchMode()">
        <a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="JsonPath匹配，考虑速度请优先使用正则匹配。注意循环匹配的站点中使用JsonPath不会循环匹配。<br/>JsonPath格式 ：rows:nth-of-type(*) > STCD">JsonPath</a>
        
        <input name="searchMode" type="radio" id="searchMode" value="label"  onclick="crawlRules.fn.changeSearchMode()">
        <a class="tooltip" style="font-weight:normal;" title="標簽組合，格式：‘${標簽名}其它字符${標簽名}’ <br/> 使用${SYSTEM-TIME} 可以獲取系統時間戳， 格式：1400595057890" href="javascript:void(0);">標簽組合</a>
        
        
        <input name="searchMode" type="radio" id="searchMode" value="auto"  onclick="crawlRules.fn.changeSearchMode()">
        <a class="tooltip" style="font-weight:normal;" title="自动标题、正文提取" href="javascript:void(0);">自动解析</a>
        
      	</td>
      	</tr></table>
      	<div  id="stringLabel" style="display:block;">
      		<div style="height:20px;color: rgb(102, 102, 102);">開始字符串(不支持正則)：</div>
      		<div style="padding-right:8px;"><textarea name="startString"  rows="4" id="startString" style="width:100%" ></textarea></div>
      		<div style="height:20px;color: rgb(102, 102, 102);">結束字符串(不支持正則)：</div>
      		<div style="padding-right:8px;"><textarea name="endString"  rows="4" id="endString" style="width:100%" ></textarea></div>
      	</div>
      	<div  id="regexLabel" style="display:none;">
      		<div style="padding-right:8px;"><textarea name="searchRegex"  rows="4" id="searchRegex" style="width:100%" class="regex"></textarea></div>
      	</div>
      	<div  id="selectLabel" style="display:none;">
      		<div style="padding-left: 3px;">
      			<div style="padding-top: 12px;height: 22px;">
      				<div style="float:left; width:355px;">
      				<input name="selectType" type="radio" id="selectType" value="outerHTML" >outerHTML
      				<input name="selectType" type="radio" id="selectType" value="innerHTML"  checked="checked">innerHTML
      				<input name="selectType" type="radio" id="selectType" value="innerTEXT">innerTEXT
      				<input name="selectType" type="radio" id="selectType" value="@ATTR">@Attribute
      				</div>
      				<div style="padding-left: 355px;"> <input type="text" id="selectAttr" style="display:none; width: 70px; height: 20px; line-height: 20px;"></div>
      			</div>
      		</div>
      		<div style="padding-right:8px;"><textarea name="selectExpress" rows="4" id="selectExpress" style="width:100%"  onkeypress="if(event.keyCode==13) return false;"></textarea></div>
      	</div>
      	
      	<div  id="labelLabel" style="display:none;">
      		<div style="padding-right:8px;"><textarea name="labelCombination" rows="4" id="labelCombination" style="width:100%" ></textarea></div>
      	</div>
      	
      	<div  id="autoLabel" style="display:none;">
      		<div style="padding-right:8px;">
	      		<select name="autoProperty" style="width:150px;">
		      		<option value="1">Headline</option>
		      		<option value="2">Content</option>
	      		</select>
      		</div>
      	</div>
      </td>
      </tr>
      
	  <tr class="mergeRules" style="display:none;">
        <td nowrap align="right" ><a class="tooltip" title="只有為站點選擇了循環匹配與合並記錄時，這個規則才會生效。 <br/>格式：<br/>1.C1，表示兩條記錄的字段在合並時直接取第壹條記錄的字段 <br/>2.C1分隔符C2 ，表示 &quot;分隔符&quot;將作為兩個字段合並時的連接字符串" href="javascript:void(0);">字段合並：</a></td>
        <td colspan="4" class="td_border" >
        <div style="padding-right:8px;">
        <textarea name="mergeRules" rows="3" id="mergeRules"  style="width:100%" ></textarea>
        </div>
        </td>
	  </tr>
	  
	  <tr>
        <td nowrap align="right" ><a class="tooltip" title="按從上到下的順序進行過濾，通過右側的移動指針可以調整過濾順序。" href="javascript:void(0);">內容過濾：</a></td>
        <td colspan="4" class="td_border">
        <table width="100%" border="0">
        	<tr>
	          <td align="right" width="100%"><a onclick="crawlRules.fn.initTable();" href="javascript:void(0);" title="排序重置">排序重置</a></td>
	        </tr>
	    </table>
        <table width="100%" border="0" id="sort_table">
        	        <tbody>
        	        
        	<tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="0" />
				<input type="hidden" name="sortIndex" value="0" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="當采集到的數據包含 (src=，herf=)這樣的HTML標簽時，自動匹配標簽內的URL地址轉為絕對地址。不包含時將自動驗證整個采集到的數據是不是壹個合法的URL地址，合法將轉為絕對地址。">絕對地址：</a></td>
            <td width="100%">
           		<div class="filterDiv">
           			<div style="height: 25px;width: 30px;float: left;padding: 8px 0 0 5px;">
           			<input name="isAbsolute" type="checkbox" id="isAbsolute" value="true" onclick="crawlRules.fn.changeOption(this)">
           			</div>
           			
           			<div style="margin: 0px 0px 0px 45px;display:none;" id="isAbsolute_option">
	           			<div style="margin: 5px 5px 2px 0px;">
		           			<div style="height: 25px;width: 90px;float: left;line-height: 25px;">
		           			<a class="tooltip" style="font-weight:normal;" title="如： BASE URL：'http：//www.newcrawler.com/' 相對地址： 'static/pic.jpg' <br/> 絕對地址是：'http：//www.newcrawler.com/static/pic.jpg <br/> 留空表示使用當前采集網址作為BASE URL'"  href="javascript:void(0);">BASE URL：</a>
		           			</div>
		           			<div style="margin: 0 0px 0 95px;">
		           			<input style="width:100%;" id="absoluteUrlBase" type="text" name="absoluteUrlBase" />
		           			</div>
		           		</div>
		           		<div style="margin: 5px 5px 2px 0px;">
		           			<div style="height: 25px;width: 90px;float: left;line-height: 25px;">
		           			<a class="tooltip" style="font-weight:normal;display: inline-block;" title="正則匹配取第壹個分組的值作為網址進行絕對地址轉換，如：(.*)。 <br/> 留空則將整個字符串當作壹個網址進行絕對地址轉換。"  href="javascript:void(0);">正則匹配網址：</a>
		           			</div>
		           			<div style="margin: 0 0px 0 95px;">
		           			<input style="width:100%;" id="absoluteUrlRegex" type="text" name="absoluteUrlRegex" /> 
		           			</div>
		           		</div>
           			</div>
				</div>
			</td>
			<td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>        
        	        
        	        
        	<tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="1" />
				<input type="hidden" name="sortIndex" value="1" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" title="當匹配到的結果是網址時可以抓取網址的內容。"  href="javascript:void(0);">抓取網址：</a></td>
            <td width="100%">
            	<div class="filterDiv">
           			<div style="height: 25px;width: 30px;float: left;padding: 8px 0 0 5px;">
           			<input name="isFetchUrl" type="checkbox" id="isFetchUrl" value="true" onclick="crawlRules.fn.changeOption(this)" >
           			</div>
           			
           			<div style="margin: 0px 0px 0px 45px;display:none;" id="isFetchUrl_option">
	           			<div style="margin: 5px 5px 2px 0px;">
		           			<div style="height: 25px;width: 90px;float: left;line-height: 25px;">
		           			<a class="tooltip" style="font-weight:normal;" title="需要在'設置' > 'HTTP請求'中定義"  href="javascript:void(0);">HTTP請求：</a>
		           			</div>
		           			<div style="margin: 0 0px 0 95px;">
		           			<select id="httpRequestId" name="httpRequestId" style="width:160px;">
          						<option value=""></option>
       						</select>
       						<span class="configBox" lang="HttpRequest.html">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
		           			</div>
		           		</div>
		           		<div style="margin: 5px 5px 2px 0px;">
		           			<div style="height: 25px;width: 90px;float: left;line-height: 25px;">
		           			<a class="tooltip" style="font-weight:normal;display: inline-block;" title="請求參數, 如：params1=value1&params2=value2&params3=value3"  href="javascript:void(0);">請求參數：</a>
		           			</div>
		           			<div style="margin: 0 0px 0 95px;">
		           			<input style="width:100%;" id="fetchUrlHttpRequestParams" type="text" name="fetchUrlHttpRequestParams" /> 
		           			</div>
		           		</div>
		           		<div style="margin: 5px 5px 2px 0px;">
		           			<div style="height: 25px;width: 90px;float: left;line-height: 25px;">
		           			<a class="tooltip" style="font-weight:normal;display: inline-block;" title="自動提取正文"  href="javascript:void(0);">正文提取</a>
		           			</div>
		           			<div style="margin: 0 0px 0 95px;">
		           			<input name="fetchUrlAutoExtract" type="checkbox" id="fetchUrlAutoExtract" value="true" onclick="crawlRules.fn.changeOption(this)" >
		           			</div>
		           		</div>
           			</div>
				</div>
			</td>
			<td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
          
          <tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="2" />
				<input type="hidden" name="sortIndex" value="2" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="編碼轉換如：'\uxxxx','&#xxxxx;'">編碼轉換：</a></td>
            <td width="100%">
           		<div class="filterDiv">
					<ul class="crawl-rules-lable">
					<li><input name="isConvertEncoding" type="checkbox" id="isConvertEncoding" value="true" onclick="crawlRules.fn.changeOption(this)"></li>
					</ul>
					<ul class="crawl-rules-lable" id="isConvertEncoding_option" style="display:none;">
					<li>
					<a class="tooltip" style="font-weight:normal;" title="Unicode編碼格式：\uxxxx\uxxxx"  href="javascript:void(0);">UNICODE</a><input name="convertEncode" type="checkbox" id="convertEncode" value="unicode" >
					</li>
					<li>
					<a class="tooltip" style="font-weight:normal;" title="ASCII編碼格式： &#xxxxx;"  href="javascript:void(0);">ASCII</a><input name="convertEncode" type="checkbox" id="convertEncode" value="ascii" > 
					</li>
					<li>
					<a class="tooltip" style="font-weight:normal;" title="HTML編碼格式： &nbsp;"  href="javascript:void(0);">HTML</a><input name="convertEncode" type="checkbox" id="convertEncode" value="html" > 
					</li>
					<li>
					<a class="tooltip" style="font-weight:normal;" title="URLEncoder編碼格式：%22%22"  href="javascript:void(0);">URLEncoder</a><input name="convertEncode" type="checkbox" id="convertEncode" value="urlEncoder" > 
					</li>
					<li>
					<a class="tooltip" style="font-weight:normal;" title="URLEncoder編碼格式：%22%22"  href="javascript:void(0);">URLDecoder</a><input name="convertEncode" type="checkbox" id="convertEncode" value="urlDecoder" > 
					</li>
					</ul>
				</div>
			</td>
			<td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
          
			<tr class="simplehighlight">
				<td>
				<input type="hidden" name="tdIndex" value="3" />
				<input type="hidden" name="sortIndex" value="3" />
				</td>
				<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" title="HTML標簽排除不區分大小寫，在標簽後帶上'+'表示排除標簽內的文本，不帶'+'的表示只排除標簽保留標簽內的文本。" href="javascript:void(0);">Html排除：</a></td>
	            <td width="100%">
			        <div id="excludeHtmlTagsDiv">
						<ul>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="a" >&lt;a&gt;</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="a+" >&lt;a&gt;+</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="div" >&lt;div&gt;</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="div+" >&lt;div&gt;+</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="span" >&lt;span&gt;</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="span+" >&lt;span&gt;+</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="b" >&lt;b&gt;</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="b+" >&lt;b&gt;+</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="p" >&lt;p&gt;</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="p+" >&lt;p&gt;+</li>
							
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="script+" >&lt;script&gt;+</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="br" >&lt;br&gt;</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="img" >&lt;img&gt;</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="enter" >Enter</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="space_trim" ><a class="tooltip" style="font-weight:normal;" title="排除前後空格" href="javascript:void(0);">Space</a></li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="space" ><a class="tooltip" style="font-weight:normal;" title="排除所有空格" href="javascript:void(0);">Space+</a></li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="tab" >Tab</li>
							<li><input name="excludeHtmlTags" type="checkbox" id="excludeHtmlTags" value="nbsp" >&amp;nbsp;</li>
						</ul>
						<div class="addLabel">
							<a id="excludeHtmlTagsAddBox" href="javascript:void(0);" onclick="crawlRules.fn.excludeHtmlTagsAddBox()">+</a>
						</div>
					</div>		        	
		        </td>
		        <td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
			</tr>
			
			<tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="4" />
				<input type="hidden" name="sortIndex" value="4" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="通過文本組合可以生成新的文本，格式：'新字符${this}新字符'，要使此規則生效必須包含'${this}'，'${this}'表示當前規則匹配到的數據。">文本組合：</a></td>
            <td width="100%">
            <div class="dataFilterDiv">
            <input name="textComposition" type="text" id="textComposition" style="width:100%;vertical-align: middle;" class="regex">
            </div>
            </td>
            <td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
          
          <tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="5" />
				<input type="hidden" name="sortIndex" value="5" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="1.如：'(\d*)'返回正則中第壹個分組的內容，無法匹配時返回NULL，默認是多次匹配用回車分隔  <br/>2.當正則表達式有括號時，返回正則中第壹個分組的內容，否則返回所有匹配的內容<br/>3.支持正則，正則表達式元字符 ^ $ ( ) * + ? . [ \ { | 加 \ 轉義將作為字符串匹配<br/>4.聚焦輸入框，按Ctrl+F自動轉義正則元字符<br/>5.不區分大小寫匹配，可以通過內嵌標誌表達式'(?i)'來啟用，從內嵌位置開始不區分大小寫">正則過濾：</a></td>
			
            <td width="100%">
           		<div class="filterDiv">
           			<div style="height: 22px;width: 85px;float: left;padding: 8px 0 0 5px;">
           			<a class="tooltip" style="font-weight:normal;display: inline-block;" title="默認是匹配多次並使用換行符'\r\n'分隔，勾選表示只返回第壹次匹配到的結果。"  href="javascript:void(0);">匹配壹次</a><input name="isSingleMatch" type="checkbox" id="isSingleMatch" value="true">
           			</div>
           			<div style="margin: 0 0px 0 90px;padding: 5px 5px 0;">
           			<input name="regexFilter" type="text" id="regexFilter" style="width:100%;vertical-align: middle;" class="regex">
           			</div>
				</div>
			</td>
			
            <td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
          
          <tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="6" />
				<input type="hidden" name="sortIndex" value="6" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="使用此過濾規則可以提取出json對象的值，但標簽匹配到的數據必須是正確的JavaScript。">JavaScript過濾：</a></td>
            <td width="100%">
            <div class="dataFilterDiv">
            <select id="dataJavascriptId" name="dataJavascriptId" style="width:160px;">
          			<option value=""></option>
       		</select>
       		<span class="configBox" lang="JavaScriptManage.html">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
            </div>
            </td>
            <td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
          
          <tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="7" />
				<input type="hidden" name="sortIndex" value="7" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="如：<br/>1.compareDate(sysDate.add(dd-2),this) 表示采集兩天以內的數據 <br/>this 表示當前規則所匹配到的日期類型的值 <br/>sysDate.add(dd-2) 表示當前時間減去2天 <br/>2.數學計算表達式如：'ceil(${this}/${標簽名}),###.##' <br/>'${this}' 獲取當前標簽的值，'${標簽名}' 只能獲取前面標簽的值。<br/>'###.##' 表示對計算結果做格式化。<br/>更多支持的函數與操作符請看:http://www.objecthunter.net/exp4j/apidocs/index.html">方法表達式：</a></td>
            <td width="100%">
            <div class="dataFilterDiv">
            <input name="functionExpression" type="text" id="functionExpression" style="width:100%;vertical-align: middle;">
            </div>
            </td>
            <td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
		  <tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="8" />
				<input type="hidden" name="sortIndex" value="8" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="如：&gt;10 或  &lt;10，規則匹配到的數據必須超過(不超過)10個漢字或字母或其它字符">字符長度：</a></td>
            <td width="100%">
            <div class="dataFilterDiv">
            <input name="textLen" type="text" id="textLen" style="width:100%;vertical-align: middle;">
            </div>
            </td>
            <td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
          <tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="9" />
				<input type="hidden" name="sortIndex" value="9" />
			</td>
			<td align="right"  nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="1.如：'R1C1(.*)'，表示第1條 記錄索引為1的字段的值，只能獲取前面記錄的值<br/>2.支持正則，正則表達式元字符 ^ $ ( ) * + ? . [ \ { | 加 \ 轉義將作為字符串匹配<br/>3.聚焦輸入框，按Ctrl+F自動轉義正則元字符<br/>4.不區分大小寫匹配，可以通過內嵌標誌表達式'(?i)'來啟用，從內嵌位置開始不區分大小寫">必須包含：</a></td>
            <td width="100%" id="sortDiv">
           		<div id="mustContainTextDiv">
					<ul class="crawl-rules-lable sortable"><li class="notRemove" style="border: 1px solid #FFFFFF">開啟正則<input name="isRegexMustContainText" type="checkbox" id="isRegexMustContainText" value="true" ></li></ul>
					<div class="addLabel">
					<a href="javascript:void(0);" id="mustContainTextAddBox" onclick="crawlRules.fn.mustContainTextAddBox()">+</a>
					</div>
				</div>
			</td>
			<td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
          <tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="10" />
				<input type="hidden" name="sortIndex" value="10" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="1.支持正則，正則表達式元字符 ^ $ ( ) * + ? . [ \ { | 加 \ 轉義將作為字符串匹配<br/>2.聚焦輸入框，按Ctrl+F自動轉義正則元字符<br/>3.不區分大小寫匹配，可以通過內嵌標誌表達式'(?i)'來啟用，從內嵌位置開始不區分大小寫">不能包含：</a></td>
             <td width="100%" id="sortDiv">
           		<div id="cantContainTextDiv">
					<ul class="crawl-rules-lable sortable"><li class="notRemove" style="border: 1px solid #FFFFFF">開啟正則<input name="isRegexCantContainText" type="checkbox" id="isRegexCantContainText" value="true" ></li></ul>
					<div class="addLabel">
					<a href="javascript:void(0);" id="cantContainTextAddBox" onclick="crawlRules.fn.cantContainTextAddBox()">+</a>
					</div>
				</div>
			</td>
			<td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
		  <tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="11" />
				<input type="hidden" name="sortIndex" value="11" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="1.支持正則，正則表達式元字符 ^ $ ( ) * + ? . [ \ { | 加 \ 轉義將作為字符串匹配<br/>2.聚焦輸入框，按Ctrl+F自動轉義正則元字符<br/>3.當匹配的是HTML標簽時系統自動嵌套匹配<br/>4.不區分大小寫匹配，可以通過內嵌標誌表達式'(?i)'來啟用，從內嵌位置開始不區分大小寫">文本排除：</a></td>
            <td width="100%" id="sortDiv">
           		<div id="excludeTextDiv">
					<ul class="crawl-rules-lable sortable"><li class="notRemove" style="border: 1px solid #FFFFFF">開啟正則<input name="isRegexExcludeText" type="checkbox" id="isRegexExcludeText" value="true" ></li></ul>
					<div class="addLabel">
					<a href="javascript:void(0);" id="excludeTextAddBox" onclick="crawlRules.fn.excludeTextAddBox()">+</a>
					</div>
				</div>
			</td>
			<td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
          
          <tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="12" />
				<input type="hidden" name="sortIndex" value="12" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="1.舊文本是必須項 <br/> 2.支持正則，正則表達式元字符 ^ $ ( ) * + ? . [ \ { | 加 \ 轉義將作為字符串匹配<br/> 3.聚焦輸入框，按Ctrl+F自動轉義正則元字符<br/>4.當匹配的是HTML標簽時系統自動嵌套匹配<br/>5.不區分大小寫匹配，可以通過內嵌標誌表達式'(?i)'來啟用，從內嵌位置開始不區分大小寫">文本替換：</a></td>
            <td width="100%" id="sortDiv">
           		<div id="replaceTextDiv">
					<ul class="crawl-rules-lable sortable"><li class="notRemove" style="border: 1px solid #FFFFFF">開啟正則<input name="isRegexReplaceText" type="checkbox" id="isRegexReplaceText" value="true" ></li></ul>
					<div class="addLabel">
					<a href="javascript:void(0);" id="replaceTextAddBox" onclick="crawlRules.fn.replaceTextAddBox()">+</a>
					</div>
				</div>
			</td>
			<td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
          
           <tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="13" />
				<input type="hidden" name="sortIndex" value="13" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="使用默認值作為采集到的數據。">默認值：</a></td>
            <td width="100%">
           		<div class="filterDiv">
           			<div style="height: 25px;width: 30px;float: left;padding: 8px 0 0 5px;">
           			<input name="isDefaultValue" type="checkbox" id="isDefaultValue" value="true" onclick="crawlRules.fn.changeOption(this)">
           			</div>
           			<div style="margin: 0 0px 0 30px;padding: 5px 5px 0;display:none;" id="isDefaultValue_option">
           				<div style="height: 25px;width: 170px;float: left;">
	           			<select id="defaultValueSel" name="defaultValueSel" style="width:160px;" onchange="crawlRules.fn.defaultValueSel(this.value)">
		          			<option value="" selected>自定義</option>
		          			<option value="${SYSTEM-TIME(yyyy-MM-dd HH:mm:ss)}">當前系統時間</option>
		          			<option value="${UUID}">唯壹標識符</option>
		       			</select>
	           			</div>
	           			<div style="margin: 0 0px 0 175px;">
	           			<input style="width:100%;" id="defaultValue" type="text" name="defaultValue" value="" /> 
	           			</div>
           			</div>
				</div>
			</td>
			<td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
          
          <tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="14" />
				<input type="hidden" name="sortIndex" value="14" />
			</td>
			<td align="right" nowrap style="width: 114px;"><a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="數據過濾接口，需要在 '設置' > 'HTTP接口'中定義，系統將規則匹配到的數據賦值給參數'content'並用Post的請求方式發送給自定義過濾接口進行處理。">過濾接口：</a></td>
            <td width="100%">
            <div class="dataFilterDiv">
           			<select id="filterInter" name="filterInter" style="width:160px;">
           			<option value=""></option>
        			</select>
        			<span class="configBox" lang="HttpInterManage.html">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
            </div>
            </td>
            <td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
          
          <tr class="simplehighlight">
            <td>
				<input type="hidden" name="tdIndex" value="15" />
				<input type="hidden" name="sortIndex" value="15" />
			</td>
			<td align="right" nowrap style="width: 114px;">
			<a class="tooltip" style="font-weight:normal;" href="javascript:void(0);" title="數據過濾插件，需要在 '設置' > '插件管理' 中定義，采集器將匹配到的數據傳遞給自定義過濾插件進行處理">過濾插件：</a>
			</td>
            <td width="100%">
            <div class="dataFilterDiv">
           			<select id="filterPlugin" name="filterPlugin" style="width:160px;">
          				<option value=""></option>
       				</select>
       				<span class="configBox" lang="PluginManage.html">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
            </div>
            </td>
            <td align="right" nowrap><div class="ui-state-default move"><span class="ui-icon ui-icon-arrow-4" title="Move"></span></div></td>
          </tr>
          </tbody>  
        </table>        
        </td>
      </tr>
	  
      <tr>
        <td nowrap align="right" ></td>
        <td colspan="4" class="td_border" >
        	<input name="isDownload" type="checkbox" id="isDownload" value="true" onclick="crawlRules.fn.changeOption(this)"><a class="tooltip" style="font-weight:normal;" title="文件下載，可以選擇插件將文件保存到雲存儲，FTP等。"  href="javascript:void(0);">文件下載</a>
        	<table id="isDownload_option" style="display:none;width:100%;">
        	<tr>
	        	<td nowrap="nowrap"   style="width: 114px;" align="right">
	        	<a class="tooltip" style="font-weight:normal;" title="文件保存插件，需要在 '設置' > '插件管理' 中定義"  href="javascript:void(0);">文件保存插件：</a>
	        	</td>
	        	<td  style="width:190px;"  align="left" nowrap>
		        	<select id="fileSavePluginId" name="fileSavePluginId" style="width:160px;">
		          			<option value=""></option>
		       		</select>
		       		<span class="configBox" lang="PluginManage.html">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
		       	</td>
		       	<td  style="width:100%;"  align="left" colspan="2"  nowrap>	
		       		<div style="width:100%;padding-bottom: 2px;">
		       			<div style="width: 115px;float: left;padding: 8px 0 0 5px;">
		       			<a class="tooltip" style="font-weight:normal;" title="通過正則匹配需要下載文件的網址，返回正則中第壹個分組的內容。<br/>常用正則: <br/>  1. ([^\r\n]+)不包含換行符的任意字符，通常用來匹配壹整行。<br/>  2. &lt;\s*img[^&lt;]+src=[&quot;'](.*?)[&quot;'][^&lt;]*?&gt; 匹配img標簽中的圖片文件"  href="javascript:void(0);">匹配文件（正則）：</a>
	           			</div>
	           			<div style="margin: 0 0px 0 115px;padding: 5px 5px 0;">
	           			<input style="width:100%;" id="fileSavePluginRegex" type="text" name="fileSavePluginRegex"/> 
	           			</div>
		       		</div>
		       		<div style="width:100%;">
		       			<div style="width: 115px;float: left;padding: 8px 0 0 5px;">
		       			<a class="tooltip" style="font-weight:normal;" title="可以使用${sysDate}獲取系統日期，日期格式：yyyyMMdd。可以使用'${標簽名}'的格式來讀取采集規則匹配到的數據。留空則不指定子目錄。"  href="javascript:void(0);">文件存放子目錄：</a>
	        			</div>
	        			<div style="margin: 0 0px 0 115px;padding: 5px 5px 0;">
	           			<input style="width:100%;" id="fileSaveSubDir" type="text" name="fileSaveSubDir"/>
	           			</div> 
		       		</div>
	        	</td>
        	</tr>
        	</table>
        </td>
	  </tr>
	  
		</table>
		 </form>
		</td>
		<td width="40%" valign="top">
		<table width="100%" height="100%" align="center" class="table_border2">
		 <tr>
			<td colspan="7" width="100%" style="padding-right:7px;">
			<textarea rows="14" name="crawlUrl" id="crawlUrl" style="width:100%"></textarea>
			</td>
			</tr>
			<tr>
			<td colspan="7" class="td_border" >
			<input type="button" value="導入規則" onClick="crawlRules.fn.importRules();">
			<input type="button" value="導出規則" onClick="crawlRules.fn.exportRules();">
			<input type="button" value="查看源碼" onClick="crawlRules.fn.viewCode();">  
			<input type="button" value="可視化配置" onClick="crawlRules.fn.readXPath();">  
			</td>
			</tr>
		<tr>
		<td colspan="5" width="100%" height="100%">
	<!-- rules start -->
	<div>
	
	<div class="rules_right">
	        <div id="rulesVersion" style="padding-top: 32px;">
			  <ul id="sortable"></ul>
			  <input type="button" value="添加" onclick="crawlRules.fn.addRulesVersion(this)"  lang="CrawlRulesVersion.html" style="margin: 0;padding: 0px 20px 0px 5px;border-left: 0;background-color: rgb(255, 255, 255);background-image: none;">  
			</div>
        </div>
        
	<div class="rules_left">
		<div id="accordion">
		<h3 style="border-bottom: 1px solid #FFFFFF;outline: none"><a href="javascript:void(0);">1.采集規則</a></h3>
		<div width="100%" height="100%">
		<table id="crawlLabelTabel"  width="100%" height="100%">
          <tr>
		    <td>
		    <div>
		    <div><input type="checkbox" name="all" id="all" onclick="crawlRules.fn.selectAll(this,'crawlLabelTabel','rules')" />選擇所有</div>
		    
		    <ul id="sortable" style="max-height: 489px; overflow-y: scroll; overflow-x: hidden; padding-right: 3px;">
		    </ul>
		    </div>
			</td>
          </tr>
          <tr>
			<td colspan="7">
			<input style="margin-left: 0px; margin-right: 5px;" type="button" value="添加" onClick="crawlRules.fn.create();">
			<input style="margin-left: 0px; margin-right: 5px;" type="button" value="刪除" onClick="crawlRules.fn.removeAll();">
			<input style="margin-left: 0px; margin-right: 5px;" type="button" value="更新" onClick="crawlRules.fn.update();">
			<input style="margin-left: 0px; margin-right: 5px;" type="button" value="采集測試" onClick="crawlRules.fn.testRules();"> 
			</td>
			</tr>
        </table>
        </div>
        
        <h3  style="border-bottom: 1px solid #FFFFFF;outline: none"><a href="javascript:void(0);">2.分頁規則</a></h3>
		<div>
			<table id="pageLabelTabel"  width="100%" height="100%">
	          <tr>
			    <td>
			    <div><input type="checkbox" name="all" id="all" onclick="crawlRules.fn.selectAll(this,'pageLabelTabel','rules')" />選擇所有</div>
			    <ul id="sortable"  style="max-height: 262px;">
			    </ul>
				</td>
	          </tr>
	          <tr>
				<td colspan="7" class="td_border">
				<input style="margin-left: 0px; margin-right: 5px;" type="button" value="添加" onClick="crawlRules.fn.create();">
				<input style="margin-left: 0px; margin-right: 5px;" type="button" value="刪除" onClick="crawlRules.fn.removeAll();">
				<input style="margin-left: 0px; margin-right: 5px;" type="button" value="更新" onClick="crawlRules.fn.update();">
				<input style="margin-left: 0px; margin-right: 5px;" type="button" value="采集測試" onClick="pageRules.fn.nextLink();">
				</td>
				</tr>
	        </table>
	        
	        <form id="pageForm" name="pageForm">
	        <table  width="100%" height="100%">
	          <tr>
	            <td class="td_border">
	            <table style="width:100%;" class="table_border2">
		            <tr><td  style="padding: 5px 5px 5px 5px">分頁設置</td></tr>
		            <tr><td  style="padding: 5px 5px 5px 5px">
		             <table style="width:100%;">
		             	<tr>
		             	<td nowrap="nowrap" width="95px"><a class="tooltip" title="1.使用  '${標簽名}' 的方式來讀取標簽值 <br/> 格式：http：//${標簽名}?pageNo=${標簽名}&amp;PARAM1=${標簽名} ... <br/> 2.可以使用分頁方法'${page(初始頁,分頁增長步長)}'，需要同分頁次數限制壹起使用，否則將不會停止分頁采集。 <br/> 格式：http：//${標簽名}?pageNo=${page(1,1)}&amp;PARAM1=${3} ... <br/> 3.可以使用分頁方法'${page(當前頁,分頁增長步長,分頁總數)}' <br/> 格式：http：//${標簽名}?pageNo=${page(1,1,8)}&amp;PARAM1=${3} ..." href="javascript:void(0);">下壹頁表達式：</a></td>
		             	
		             	<td class="td_border">
		             	<div style="padding-right:2px;">
						<textarea rows="4" id="nextLinkExpress" 
							name="nextLinkExpress" style="word-break:break-all;overflow-y:visible;height:60px;width:100%;padding: 0px;margin: 0px"></textarea>
						</div>
		             	</td>
		             	</tr>
		             	<tr>
		             	<td nowrap="nowrap" width="95px"><a class="tooltip" title="1.當只需要抓取前面幾頁時可以使用分頁次數限制。<br/> 2.可使用  '${標簽名}' 的方式來讀取標簽值。 <br/> 3.可直接使用數字來限制分頁次數，0或留空則表示不限制。" href="javascript:void(0);">分頁次數限制：</a></td>
		             	<td class="td_border">
		             	<div class="inputOver">
		             	<input name="nextPageMaxTimes" type="text" id="nextPageMaxTimes" value="" style="width:100%;"/>
		             	</div>
		             	</td>
		             	</tr>
		             	
		             	<tr>
		             	<td nowrap="nowrap" width="95px"><a class="tooltip" title="當分頁模板與第壹頁模板不同時，可以設置此參數調用其它站點的規則進行采集。" href="javascript:void(0);">分頁匹配規則：</a></td>
		             	<td class="td_border">
		             	<select id="nextLinkMatchRules" name="nextLinkMatchRules" style="width:160px;"></select>
		             	</td>
		             	</tr>
		             	
		             	<tr>
		             	<td></td>
		             	<td class="td_border"><input type="button" value="保存" onClick="pageRules.fn.save();"></td>
		             	</tr>
		             </table>
		            </td></tr>
	            </table>
	            </td>
	          </tr>
	        </table>
	        </form>
		</div>
        </div> </div>
        
        </div>
     <!-- rules end -->   
		</td>
		</tr>
		</table>
		</td>
      </tr>
      <tr>
      <td colspan="9" >
      <table width="100%" class="table_border2">
      	<tr>
      		<td width="82">采集結果：</td>
      	</tr>
      	<tr>
      		<td style="padding-right:7px;">
     	 		<textarea  name="crawlResult" id="crawlResult" style="width:100%; height:300px; overflow-x:hidden; overflow-y:auto;" readonly="readonly"></textarea>
      		</td>
      	</tr>
      </table>
      </td>
      </tr>
  </table>
  
<script type="text/javascript">

$(document).ready(function(){
	var initFun= function(){
		pageRules.v.siteJson=siteJsonData;
		pageRules.v.webCrawlerId=webCrawlerId;
		pageRules.v.siteId=siteId;
		
		crawlRules.v.siteJson=siteJsonData;
		crawlRules.fn.init();
	  };
	
	var initLoading=setInterval(function(){
		if(typeof crawlRules != 'undefined'){
			clearInterval(initLoading);
			initFun();
		}
	},500);
	
});
</script>
</body>
</html>
